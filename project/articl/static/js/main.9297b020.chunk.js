(this["webpackJsonpreact-pro"]=this["webpackJsonpreact-pro"]||[]).push([[0],{183:function(e,t,a){e.exports=a(369)},206:function(e,t,a){},254:function(e,t,a){e.exports=a.p+"static/media/login_bg.69751b48.jpg"},255:function(e,t,a){},258:function(e,t,a){},259:function(e,t,a){},275:function(e,t,a){},280:function(e,t,a){},368:function(e,t,a){},369:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(4),r=a.n(o),s=(a(188),a(17)),l=a(18),c=a(20),u=a(19),m=a(21),d=a(31),f=a(44),p=a(27),h=a.n(p),g=a(371),v=a(372),y=(a(206),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={isRegister:!1,account:"",loginState:0},a.loginBtn=function(){if(a.state.isRegister){var e={user:a.regstUser.value,pass:a.regstPass.value};if(a.regstPass.value!==a.regstPass2.value)return void g.a.info("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4");h.a.post("/api/regst",e).then((function(e){if(2===e.data.code)g.a.info("\u5e10\u53f7\u6216\u5bc6\u7801\u4e3a\u7a7a");else if(0===e.data.code){var t=e.data.data;a.setState({account:t,isRegister:!1}),a.openNotification(),a.regstUser.value="",a.regstPass.value="",a.regstPass2.value=""}}))}else{var t={id:a.loginUser.value,pass:a.loginPass.value};h.a.post("/api/login",t).then((function(e){switch(e.data.code){case 2:return g.a.info("\u5e10\u53f7\u6216\u5bc6\u7801\u4e3a\u7a7a");case 1:return g.a.info("\u5e10\u53f7\u6216\u5bc6\u7801\u9519\u8bef");case 0:return sessionStorage.loginState=1,localStorage.userInfo=JSON.stringify(e.data.data),a.setState({loginState:1});default:return alert("\u767b\u9646\u9519\u8bef")}}))}},a.goRegt=function(){var e=!a.state.isRegister;a.setState({isRegister:e})},a.openNotification=function(){var e={message:"\u6ce8\u518c\u6210\u529f",description:"\u767b\u5f55\u5e10\u53f7\u4e3a: ".concat(a.state.account),duration:3};v.a.open(e)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=sessionStorage.loginState;this.setState({loginState:e})}},{key:"render",value:function(){var e=this;if(this.state.loginState)return i.a.createElement(f.a,{to:"/index/home"});var t=a(254),n=this.state.isRegister,o={background:n?"#fff":"#ed2553",color:n?"#ed2553":"#fff"},r={color:n?"#fff":"#ed2553",borderLeft:"5px solid ".concat(n?"#fff":"#ed2553")};return i.a.createElement("div",{id:"login",style:{background:"url(".concat(t,") no-repeat 0 0 /100% 100%")}},i.a.createElement("div",{id:"aTitle"},"\u6587\u7ae0\u7ba1\u7406\u7cfb\u7edf"),i.a.createElement("div",{id:"login_tab",style:{background:n?"#ed2553":"#fff"}},i.a.createElement("h2",{className:"tab_title",style:r},n?"\u6ce8\u518c":"\u767b\u5f55"),i.a.createElement("div",{className:"login_item login"},i.a.createElement("div",{className:"myForm",style:{display:n?"none":"block"}},i.a.createElement("input",{type:"text",className:"input",placeholder:"\u5e10\u53f7",ref:function(t){e.loginUser=t}}),i.a.createElement("input",{type:"password",className:"input",placeholder:"\u5bc6\u7801",ref:function(t){e.loginPass=t}})),i.a.createElement("div",{className:"myForm register",style:{display:n?"block":"none"}},i.a.createElement("input",{type:"text",className:"input",placeholder:"\u6635\u79f0",ref:function(t){e.regstUser=t}}),i.a.createElement("input",{type:"password",className:"input",placeholder:"\u5bc6\u7801",ref:function(t){e.regstPass=t}}),i.a.createElement("input",{type:"password",className:"input",placeholder:"\u786e\u8ba4\u5bc6\u7801",ref:function(t){e.regstPass2=t}}))),i.a.createElement("span",{className:"goRegt",style:o,onClick:this.goRegt},n?"\u767b\u5f55":"\u6ce8\u518c"),i.a.createElement("div",{className:"login_button",style:o,onClick:this.loginBtn},n?"\u6ce8\u518c":"\u767b\u5f55")))}}]),t}(n.Component)),E=a(6),b=a(377),S=a(374),N=a(376),k=a(29),O=(a(255),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={imageUrl:"",user:"",isShow:!1},a.infoChange=function(){a.props.showModal()},a.loginOut=function(){sessionStorage.loginState="",a.props.loginOut()},a.stateChange=function(){var e=!a.state.isShow;a.setState({isShow:e})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.userInfo);this.setState({imageUrl:e.imgUrl,user:e.user})}},{key:"UNSAFE_componentWillReceiveProps",value:function(){var e=this.props.info,t=e.imageUrl,a=e.user;if(e.type){var n=!this.state.isShow;this.setState({user:a,imageUrl:t,isShow:n})}}},{key:"render",value:function(){var e=this.state,t=e.imageUrl,a=e.user;return i.a.createElement("div",{className:"header"},i.a.createElement("div",{className:"userInfo"},i.a.createElement("div",{className:"infoShow",onClick:this.stateChange},i.a.createElement("div",{className:"avatar"},i.a.createElement("img",{src:t,alt:""})),i.a.createElement("div",{className:"user"}," ",a," ")),i.a.createElement("div",{className:"fnBtn",style:{display:this.state.isShow?"block":"none"}},i.a.createElement("div",null,i.a.createElement(k.a,{onClick:this.infoChange},"\u4fee\u6539"),i.a.createElement(k.a,{onClick:this.loginOut},"\u9000\u51fa")))))}}]),t}(n.Component)),C=a(375),w=(a(258),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={item:"",user:""},a.back=function(){console.log(a.props.history.goBack())},a.renderTime=function(e){var t=new Date(e).toJSON();return new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(sessionStorage.detail),t=JSON.parse(localStorage.userInfo).user;this.setState({item:e,user:t})}},{key:"render",value:function(){var e={__html:this.state.item.content},t=this.renderTime(this.state.item.time),a=this.state.user;return i.a.createElement("div",{id:"detail"},i.a.createElement("header",null,i.a.createElement("div",{className:"back"},i.a.createElement("div",{className:"goback",onClick:this.back},i.a.createElement(E.a,{type:"arrow-left",className:"arrow-left"}),i.a.createElement("span",null,"\u8fd4\u56de")),i.a.createElement("span",{className:"title"},this.state.item.title)),i.a.createElement("div",{className:"info"},i.a.createElement("span",{className:"user"},"\u4f5c\u8005: ",a),i.a.createElement("span",null," ",t))),i.a.createElement("div",{className:"cont",dangerouslySetInnerHTML:e}))}}]),t}(n.Component)),j=(a(259),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={id:"",list:[],officialCount:0,draftCount:0,type:0,page:8,current:1},a.goSub=function(){a.props.history.push("/index/publish")},a.detail=function(e){sessionStorage.detail=JSON.stringify(e)},a.remove=function(e){h.a.post("/api/delOfficial",{uid:e.uid}).then((function(t){var n=a.state.list.filter((function(t){return e.uid!==t.uid})),i=a.state.officialCount-1;a.setState({list:n,officialCount:i})}))},a.compile=function(e){var t=a.state.list.filter((function(t){return t.uid!==e.uid}));a.setState({list:t}),sessionStorage.draft=JSON.stringify(e),a.props.history.push("/index/publish"),h.a.post("/api/delDraft",{uid:e.uid}).then((function(e){}))},a.draft=function(){a.setState({type:1,current:1});var e=a.state,t=e.id,n=e.page;a.getList(t,n,0,1)},a.official=function(){a.setState({type:0,current:1});var e=a.state,t=e.id,n=e.page;a.getList(t,n,0,0)},a.changePage=function(e){a.setState({current:e});var t=a.state,n=t.page,i=t.type,o=t.id;e=n*(e-1),a.getList(o,n+e,e,i)},a.change=function(){a.setState({current:1})},a.renderTime=function(e){var t=new Date(e).toJSON();return new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.userInfo).id;h.a.get("/api/count?id="+t).then((function(t){e.setState({officialCount:t.data.data.officialCount,draftCount:t.data.data.draftCount})})),this.setState({id:t});var a=this.state,n=a.page,i=a.type;this.getList(t,n,0,i)}},{key:"getList",value:function(e,t,a,n){var i=this;h.a.get("/api/list?id=".concat(e,"&type=").concat(n,"&current=").concat(a,"&page=").concat(t)).then((function(e){var t=e.data.data;i.setState({list:t})}))}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"render",value:function(){var e=this,t=this.state,a=t.draftCount,n=t.officialCount,o=t.list,r=t.type,s=t.current,l=r?a:n,c="",u=[];return c=0===r?0===n?"none":"block":0===a?"none":"block",u=o.length?o.map((function(t,a){return i.a.createElement("div",{className:"item",style:{background:a%2===0?"#fff":"#ccc"},key:a},i.a.createElement(d.b,{to:e.props.match.url+"/detail"}," ",i.a.createElement("span",{className:"title",onClick:function(){e.detail(t)}}," ",t.title," ")),i.a.createElement("div",null,i.a.createElement("span",{className:"date"},e.renderTime(t.time)),i.a.createElement("span",{className:"del",onClick:function(){e.remove(t)},style:{display:r?"none":"inline-block"}},"\u5220\u9664"),i.a.createElement("span",{className:"del",onClick:function(){e.compile(t)},style:{display:r?"inline-block":"none"}},"\u7f16\u8f91")))})):i.a.createElement("div",{className:"item"},i.a.createElement("span",null,"\u8fd8\u6709\u6ca1\u5185\u5bb9\u55f7~~~ ",i.a.createElement(k.a,{type:"primary",style:{display:r?"none":"inline-block"},onClick:this.goSub},"\u53bb\u53d1\u5e03"))),i.a.createElement(d.a,null,i.a.createElement("div",{id:"home"},i.a.createElement("div",{className:"tab"},i.a.createElement(k.a,{type:this.state.type?"":"primary",onClick:this.official},"\u6587\u7ae0\u5217\u8868\uff08",n,"\uff09"),i.a.createElement(k.a,{type:this.state.type?"primary":"",onClick:this.draft},"\u8349\u7a3f\u7bb1\uff08",a,"\uff09")),i.a.createElement("div",{className:"item-cont"},u),i.a.createElement(C.a,{current:s,defaultPageSize:this.page,total:l+2,style:{display:c},ref:"pagination",onChange:this.changePage}),i.a.createElement(f.b,{path:this.props.match.url+"/detail",component:w})))}}]),t}(n.Component)),x=a(174),U=a.n(x),T=a(373),L=(a(275),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={editorContent:"",visible:!1,confirmLoading:!1,title:"",id:""},a.save=function(){a.submitText("saveOfficial","\u5df2\u53d1\u5e03")},a.submitText=function(e,t){if(a.state.title&&a.state.editorContent){var n=a.state.id,i=a.state.editorContent,o={id:n,title:a.state.title,content:i};h.a.post("/api/"+e,o).then((function(e){0===e.data.code&&(g.a.info(t),sessionStorage.draft="",a.props.history.push("/index/home"))}))}else g.a.info("\u8bf7\u8f93\u5165\u6587\u7ae0\u53ca\u6587\u7ae0\u540d")},a.draft=function(){a.submitText("saveDraft","\u5df2\u5b58\u5165\u8349\u7a3f\u7bb1")},a.title=function(e){var t=e.target.value;a.setState({title:t})},a.confirm=function(){sessionStorage.draft="",a.props.history.push("/index/home")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.userInfo).id;this.setState({id:t});var a=this.refs.editorElemMenu,n=this.refs.editorElemBody,i=new U.a(a,n);if(i.customConfig.onchange=function(t){console.log(i.txt.html()),e.setState({editorContent:i.txt.html()})},i.customConfig.menus=["head","bold","fontSize","fontName","italic","underline","strikeThrough","foreColor","backColor","link","list","justify","quote","emoticon","image","undo","redo"],i.customConfig.uploadImgShowBase64=!0,i.create(),sessionStorage.draft){var o=JSON.parse(sessionStorage.draft);o&&(this.setState({title:o.title,editorContent:o.content}),i.textSelector.children[0].innerHTML=o.content)}}},{key:"render",value:function(){return i.a.createElement("div",{className:"shop"},i.a.createElement("div",{className:"fn-btn"},i.a.createElement("div",{className:"detail"},"\u7528\u6587\u5b57\u8bb0\u5f55\u7f8e\u597d\u751f\u6d3b"),i.a.createElement(k.a,{type:"primary",className:"save",onClick:this.save},"\u53d1\u5e03"),i.a.createElement(k.a,{type:"primary",className:"save",onClick:this.draft},"\u5b58\u8349\u7a3f"),i.a.createElement(T.a,{placement:"bottom",title:"\u786e\u5b9a\u9000\u51fa\u5e76\u8fd4\u56de\u9996\u9875\uff1f",onConfirm:this.confirm,okText:"Yes",cancelText:"No"},i.a.createElement(k.a,{type:"primary",className:"save",onClick:this.cancel},"\u53d6\u6d88"))),i.a.createElement(N.a,{className:"title",placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u540d",value:this.state.title,onChange:this.title}),i.a.createElement("div",{className:"text-area"},i.a.createElement("div",{className:"editorElem-menu",ref:"editorElemMenu",style:{backgroundColor:"#f1f1f1",border:"1px solid #ccc"}}),i.a.createElement("div",{className:"editorElem-body",ref:"editorElemBody",style:{padding:"0 10px",overflowY:"scroll",height:400,border:"1px solid #ccc",borderTop:"none"}})))}}]),t}(n.Component)),J=(a(280),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={visible:!1,confirmLoading:!1,loading:!1,imageUrl:"",imgUrl:"",user:"",type:!1},a.handleOk=function(){var e=a.state.imageUrl,t=a.user.state.value;if(""!==e&&void 0!==t){a.setState({user:t});var n={id:JSON.parse(localStorage.userInfo).id,imageUrl:e,user:t};a.setState({confirmLoading:!0,type:!0}),h.a.post("/api/updateInfo",n).then((function(e){console.log(e.data),0===e.data.code&&(a.setState({confirmLoading:!1,visible:!1,type:!1}),localStorage.userInfo=JSON.stringify(e.data.data))}))}else g.a.info("\u8bf7\u586b\u5199\u5b8c\u6574\u4fe1\u606f")},a.handleChange=function(e){if("uploading"!==e.file.status){if("done"===e.file.status){I(e.file.originFileObj,(function(e){return a.setState({imageUrl:e,loading:!1})}));var t=e.file.name;a.setState({imgUrl:t})}}else a.setState({loading:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.showModal=function(){a.setState({visible:!0})},a.loginOut=function(){sessionStorage.loginState="",a.props.history.push("/login")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=i.a.createElement("div",null,i.a.createElement(E.a,{type:this.state.loading?"loading":"plus"}),i.a.createElement("div",{className:"ant-upload-text"},"Upload")),a=this.props.match.url,n=this.state,o=n.visible,r=n.confirmLoading,s=n.imageUrl,l=n.user,c=n.type;return i.a.createElement(d.a,null,i.a.createElement("div",{id:"index"},i.a.createElement(O,{loginOut:this.loginOut,showModal:this.showModal,info:{imageUrl:s,user:l,type:c}}),i.a.createElement("div",{className:"content"},i.a.createElement("nav",{id:"nav"},i.a.createElement(d.c,{to:a+"/home"},"\u9996\u9875"),i.a.createElement(d.c,{to:a+"/publish"},"\u53d1\u5e03\u6587\u7ae0")),i.a.createElement("div",{className:"right-cont"},i.a.createElement(f.b,{path:"/index/home",component:j}),i.a.createElement(f.b,{path:"/index/publish",component:L}))),i.a.createElement(b.a,{className:"modal",title:"\u4fee\u6539\u8d44\u6599",visible:o,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.handleOk,confirmLoading:r,onCancel:this.handleCancel},i.a.createElement(S.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:P,onChange:this.handleChange},s?i.a.createElement("img",{src:s,alt:"avatar",style:{width:"100%"}}):t),i.a.createElement("div",{className:"nickname"},i.a.createElement("span",{className:"name"},"\u6635\u79f0\uff1a"),i.a.createElement(N.a,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u7684\u6635\u79f0",ref:function(t){return e.user=t}})))))}}]),t}(n.Component));function I(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}function P(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||g.a.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||g.a.error("Image must smaller than 2MB!"),t&&a}var D=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(d.a,null,i.a.createElement("div",{className:"container"},i.a.createElement(f.a,{from:"/",to:"/login"}),i.a.createElement(f.b,{path:"/login",component:y}),i.a.createElement(f.b,{path:"/index",component:J})))}}]),t}(n.Component);a(368),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[183,1,2]]]);
//# sourceMappingURL=main.9297b020.chunk.js.map